# 유스케이스 명세서: 장소 검색 및 탐색

## 문서 정보

- **버전**: 1.0.0
- **최종 수정일**: 2025-10-21
- **작성자**: Development Team
- **문서 상태**: Draft
- **관련 문서**:
  - [사용자 플로우](/docs/userflow.md)
  - [PRD](/docs/prd.md)

---

## 개요

이 문서는 맛집 지도 서비스의 "장소 검색 및 탐색" 기능에 대한 상세한 유스케이스를 정의합니다. 사용자가 원하는 맛집을 찾고 탐색하는 모든 시나리오를 다룹니다.

---

## UC-001: 키워드로 장소 검색

### 기본 정보

- **유스케이스 ID**: UC-001
- **유스케이스 이름**: 키워드로 장소 검색
- **액터**: 일반 사용자
- **우선순위**: P0 (Must Have)
- **복잡도**: 중간

### 사전 조건

- 사용자가 홈 페이지에 접속한 상태
- 네이버 로컬 검색 API가 정상 작동 중
- 사용자의 인터넷 연결이 활성화된 상태

### 사후 조건

- 검색 결과가 화면에 표시됨
- 검색어가 최근 검색어 목록에 저장됨 (로컬 스토리지)
- 사용자가 선택한 장소가 지도에 표시됨

### 기본 플로우

1. 사용자가 헤더의 검색바를 클릭한다
2. 시스템이 검색 모달/드로어를 연다
3. 시스템이 최근 검색어 목록을 로컬 스토리지에서 로드하여 표시한다 (최대 10개)
4. 사용자가 검색어를 입력한다
5. 시스템이 300ms 디바운싱을 적용한다
6. 시스템이 네이버 로컬 검색 API를 호출한다
7. 시스템이 검색 결과 리스트를 렌더링한다:
   - 장소명
   - 주소
   - 카테고리
   - 거리 (현재 위치 기준)
8. 시스템이 정렬 옵션을 제공한다 (거리순, 평점순)
9. 사용자가 검색 결과 중 하나를 클릭한다
10. 시스템이 검색어를 최근 검색어에 추가한다 (로컬 스토리지)
11. 시스템이 지도를 해당 위치로 이동한다
12. 시스템이 해당 장소 마커를 강조 표시한다
13. 시스템이 장소 상세 페이지로 이동한다 (`/place/[placeId]`)
14. 시스템이 검색 모달/드로어를 닫는다

### 대체 플로우

#### AF-001-1: 검색 결과 없음

**분기점**: 기본 플로우 7단계 이후

1. 네이버 API가 빈 결과를 반환한다
2. 시스템이 "검색 결과가 없습니다" 안내 메시지를 표시한다
3. 시스템이 사용자에게 다른 검색어를 시도하도록 유도한다
4. 사용자가 새로운 검색어를 입력하거나 검색을 종료한다

#### AF-001-2: 최근 검색어 선택

**분기점**: 기본 플로우 4단계 대신

1. 사용자가 최근 검색어 목록에서 검색어를 클릭한다
2. 시스템이 해당 검색어로 자동 검색을 실행한다
3. 기본 플로우 6단계로 이동한다

#### AF-001-3: 검색 결과 정렬 변경

**분기점**: 기본 플로우 8단계 이후

1. 사용자가 정렬 옵션을 변경한다 (거리순 ↔ 평점순)
2. 시스템이 검색 결과를 선택한 정렬 기준으로 재정렬한다
3. 시스템이 재정렬된 결과 리스트를 렌더링한다
4. 기본 플로우 9단계로 이동한다

#### AF-001-4: 최근 검색어 개별 삭제

**분기점**: 기본 플로우 3단계 이후

1. 사용자가 최근 검색어 항목의 삭제 버튼을 클릭한다
2. 시스템이 로컬 스토리지에서 해당 검색어를 제거한다
3. 시스템이 최근 검색어 목록을 갱신한다

### 예외 플로우

#### EF-001-1: 네이버 API 호출 실패

**발생 시점**: 기본 플로우 6단계

1. 네이버 로컬 검색 API 호출이 실패한다 (네트워크 오류, 서버 오류 등)
2. 시스템이 에러를 캐치한다
3. 시스템이 토스트 메시지로 "검색 중 오류가 발생했습니다. 다시 시도해주세요." 표시한다
4. 시스템이 검색 입력 필드를 활성화 상태로 유지한다
5. 사용자가 재시도하거나 검색을 종료한다

#### EF-001-2: API 할당량 초과

**발생 시점**: 기본 플로우 6단계

1. 네이버 API 일일 할당량(25,000건)을 초과한다
2. API가 429 (Too Many Requests) 에러를 반환한다
3. 시스템이 토스트 메시지로 "일일 검색 한도를 초과했습니다. 내일 다시 시도해주세요." 표시한다
4. 시스템이 검색 입력 필드를 비활성화한다

#### EF-001-3: 네트워크 연결 끊김

**발생 시점**: 기본 플로우 6단계

1. 사용자의 인터넷 연결이 끊긴다
2. API 호출이 타임아웃된다
3. 시스템이 토스트 메시지로 "네트워크 연결을 확인해주세요" 표시한다
4. 시스템이 재시도 버튼을 제공한다

#### EF-001-4: 로컬 스토리지 용량 초과

**발생 시점**: 기본 플로우 10단계

1. 로컬 스토리지 용량이 초과된다
2. 시스템이 가장 오래된 검색어를 자동으로 삭제한다
3. 시스템이 새 검색어를 저장한다
4. 기본 플로우 11단계로 이동한다

### 비기능 요구사항

- **성능**: 검색어 입력 후 300ms 디바운싱 적용
- **성능**: API 응답 시간 500ms 이내 (p95)
- **용량**: 최근 검색어 최대 10개 저장
- **보안**: 검색어 XSS 방지를 위한 입력값 sanitization
- **접근성**: 검색 입력 필드에 적절한 aria-label 적용
- **접근성**: 키보드만으로 검색 가능 (Enter 키 지원)

### 테스트 시나리오

#### TS-001-1: 기본 검색 성공

- 검색어: "강남역 맛집"
- 예상 결과: 강남역 주변 맛집 목록 표시

#### TS-001-2: 특수 문자 포함 검색

- 검색어: "고기집 @강남"
- 예상 결과: 특수 문자 필터링 후 검색 실행

#### TS-001-3: 공백만 입력

- 검색어: "   "
- 예상 결과: 검색 실행되지 않음

#### TS-001-4: 매우 긴 검색어

- 검색어: 100자 이상의 긴 텍스트
- 예상 결과: 적절히 잘라서 검색 또는 경고 메시지 표시

---

## UC-002: 지도에서 장소 탐색

### 기본 정보

- **유스케이스 ID**: UC-002
- **유스케이스 이름**: 지도에서 장소 탐색
- **액터**: 일반 사용자
- **우선순위**: P0 (Must Have)
- **복잡도**: 높음

### 사전 조건

- 사용자가 홈 페이지에 접속한 상태
- 네이버 지도 SDK가 정상적으로 로드됨
- 데이터베이스에 리뷰가 있는 장소 데이터가 존재함

### 사후 조건

- 지도 영역에 해당하는 장소 마커들이 표시됨
- 사용자가 마커를 클릭하여 장소 상세 정보를 확인할 수 있음

### 기본 플로우

1. 사용자가 홈 페이지에 접속한다
2. 시스템이 네이버 지도를 초기화한다
3. 시스템이 사용자에게 위치 권한을 요청한다
4. 사용자가 위치 권한을 허용한다
5. 시스템이 현재 위치를 기준으로 지도를 초기화한다 (줌 레벨 15)
6. 시스템이 현재 지도 영역의 경계(bounds)를 계산한다
7. 시스템이 해당 영역 내 리뷰가 있는 장소 데이터를 요청한다 (`GET /api/places?lat1=...&lng1=...&lat2=...&lng2=...`)
8. 시스템이 장소 마커를 지도에 렌더링한다:
   - 카테고리별 아이콘 구분
   - 평균 평점에 따른 색상 구분 (선택사항)
9. 사용자가 지도를 드래그하여 이동하거나 줌을 조절한다
10. 시스템이 지도 조작 완료(`idle` 이벤트)를 감지한다
11. 시스템이 새로운 영역 범위를 계산한다
12. 시스템이 해당 영역 내 장소 데이터를 요청한다
13. 시스템이 기존 마커를 제거하고 새 마커를 렌더링한다
14. 사용자가 마커를 클릭한다
15. 시스템이 장소 상세 페이지로 이동한다 (`/place/[placeId]`)

### 대체 플로우

#### AF-002-1: 위치 권한 거부

**분기점**: 기본 플로우 4단계 대신

1. 사용자가 위치 권한을 거부한다
2. 시스템이 토스트 메시지로 "위치 권한이 필요합니다" 표시한다
3. 시스템이 기본 위치(서울시청)를 중심으로 지도를 초기화한다
4. 기본 플로우 6단계로 이동한다

#### AF-002-2: 마커 클러스터링 활성화

**분기점**: 기본 플로우 8단계

**조건**: 줌 레벨이 13 미만일 때

1. 시스템이 근접한 마커들을 그룹화한다
2. 시스템이 클러스터 마커를 표시한다 (그룹 내 장소 개수 표시)
3. 사용자가 클러스터 마커를 클릭한다
4. 시스템이 해당 영역으로 줌인한다
5. 시스템이 개별 마커들을 표시한다

#### AF-002-3: 영역 내 장소 없음

**분기점**: 기본 플로우 7단계 이후

1. API가 빈 결과를 반환한다 (해당 영역에 리뷰가 있는 장소 없음)
2. 시스템이 마커를 표시하지 않는다
3. 시스템이 지도 하단에 "이 지역에 리뷰가 없습니다" 안내 메시지를 표시한다 (3초 후 자동 사라짐)
4. 사용자가 지도를 다른 영역으로 이동한다

#### AF-002-4: 지도 영역이 너무 넓음

**분기점**: 기본 플로우 7단계

**조건**: 줌 레벨이 10 미만일 때

1. 시스템이 API 호출을 스킵한다
2. 시스템이 지도 하단에 "지도를 확대해주세요" 안내 메시지를 표시한다
3. 사용자가 줌인한다
4. 기본 플로우 11단계로 이동한다

### 예외 플로우

#### EF-002-1: 지도 SDK 로드 실패

**발생 시점**: 기본 플로우 2단계

1. 네이버 지도 SDK 로드가 실패한다
2. 시스템이 에러 페이지를 표시한다
3. 시스템이 "지도를 불러올 수 없습니다. 페이지를 새로고침해주세요." 메시지를 표시한다
4. 시스템이 새로고침 버튼을 제공한다

#### EF-002-2: 위치 정보 획득 실패

**발생 시점**: 기본 플로우 5단계

1. 위치 정보 획득에 실패한다 (GPS 오류, 타임아웃 등)
2. 시스템이 토스트 메시지로 "위치를 가져올 수 없습니다" 표시한다
3. 시스템이 기본 위치(서울시청)로 폴백한다
4. 기본 플로우 6단계로 이동한다

#### EF-002-3: 장소 데이터 로드 실패

**발생 시점**: 기본 플로우 7단계

1. 장소 데이터 API 호출이 실패한다
2. 시스템이 에러를 캐치한다
3. 시스템이 토스트 메시지로 "장소 정보를 불러올 수 없습니다" 표시한다
4. 시스템이 기존 마커를 유지하거나 빈 지도를 표시한다
5. 시스템이 재시도 버튼을 제공한다

#### EF-002-4: 마커 렌더링 성능 저하

**발생 시점**: 기본 플로우 8단계

**조건**: 마커 개수가 100개를 초과할 때

1. 시스템이 마커 개수를 확인한다
2. 시스템이 강제로 클러스터링 모드로 전환한다
3. 시스템이 클러스터된 마커를 렌더링한다
4. 시스템이 토스트 메시지로 "장소가 많아 그룹으로 표시됩니다" 안내한다

### 비기능 요구사항

- **성능**: 지도 초기화 시간 1초 이내
- **성능**: 마커 렌더링 시간 500ms 이내 (100개 기준)
- **성능**: 지도 이동 후 디바운싱 300ms 적용
- **UX**: 마커 클릭 영역 최소 44x44px (터치 친화적)
- **UX**: 지도 조작 중 로딩 인디케이터 표시
- **접근성**: 마커에 적절한 aria-label 적용
- **최적화**: 보이는 영역만 데이터 로딩 (viewport culling)

### 테스트 시나리오

#### TS-002-1: 초기 로딩 테스트

- 조건: 위치 권한 허용, 서울 강남역 위치
- 예상 결과: 강남역 주변 맛집 마커 표시

#### TS-002-2: 지도 드래그 테스트

- 조건: 지도를 홍대 방향으로 드래그
- 예상 결과: 홍대 주변 맛집 마커로 갱신

#### TS-002-3: 줌인/줌아웃 테스트

- 조건: 줌 레벨 15 → 12 → 15
- 예상 결과: 클러스터링 활성화 → 비활성화

#### TS-002-4: 성능 테스트

- 조건: 마커 200개 영역으로 이동
- 예상 결과: 클러스터링 자동 활성화, 렌더링 지연 없음

---

## UC-003: 카테고리별 필터링

### 기본 정보

- **유스케이스 ID**: UC-003
- **유스케이스 이름**: 카테고리별 필터링
- **액터**: 일반 사용자
- **우선순위**: P1 (Should Have)
- **복잡도**: 낮음

### 사전 조건

- 사용자가 홈 페이지에 접속한 상태
- 지도가 정상적으로 로드되어 있음
- 지도에 여러 카테고리의 장소 마커가 표시되어 있음

### 사후 조건

- 선택한 카테고리의 장소 마커만 지도에 표시됨
- 필터 상태가 UI에 반영됨 (선택된 카테고리 강조)

### 기본 플로우

1. 사용자가 홈 페이지 하단의 카테고리 필터바를 확인한다
2. 시스템이 카테고리 옵션을 표시한다:
   - 전체
   - 한식
   - 일식
   - 양식
   - 중식
   - 카페
   - 기타
3. 사용자가 특정 카테고리 버튼을 클릭한다 (예: "한식")
4. 시스템이 선택된 카테고리 상태를 업데이트한다 (Zustand 스토어)
5. 시스템이 현재 지도 영역 내 필터링된 카테고리의 마커만 표시한다
6. 시스템이 선택된 카테고리 버튼을 강조 표시한다 (색상 변경)
7. 시스템이 마커를 재렌더링한다
8. 시스템이 지도 하단에 "한식 XX개 표시 중" 정보를 표시한다 (선택사항)

### 대체 플로우

#### AF-003-1: 다중 카테고리 선택

**분기점**: 기본 플로우 3단계

1. 사용자가 추가로 다른 카테고리를 클릭한다 (예: "일식")
2. 시스템이 선택된 카테고리 목록에 추가한다 (["한식", "일식"])
3. 시스템이 두 카테고리에 해당하는 마커를 모두 표시한다
4. 시스템이 선택된 두 카테고리 버튼을 강조 표시한다
5. 기본 플로우 7단계로 이동한다

#### AF-003-2: 카테고리 선택 해제

**분기점**: 기본 플로우 3단계

**조건**: 이미 선택된 카테고리를 다시 클릭

1. 사용자가 이미 선택된 카테고리를 다시 클릭한다
2. 시스템이 해당 카테고리를 선택 해제한다
3. 시스템이 해당 카테고리의 마커를 지도에서 제거한다
4. 시스템이 카테고리 버튼 강조를 해제한다
5. 기본 플로우 7단계로 이동한다

#### AF-003-3: "전체" 카테고리 선택

**분기점**: 기본 플로우 3단계

1. 사용자가 "전체" 버튼을 클릭한다
2. 시스템이 모든 카테고리 선택을 해제한다
3. 시스템이 모든 카테고리의 마커를 표시한다
4. 시스템이 "전체" 버튼만 강조 표시한다
5. 기본 플로우 7단계로 이동한다

#### AF-003-4: 필터링 후 지도 이동

**분기점**: 기본 플로우 8단계 이후

1. 사용자가 카테고리 필터 적용 상태에서 지도를 이동한다
2. 시스템이 새로운 영역의 장소 데이터를 요청한다
3. 시스템이 선택된 카테고리 필터를 유지한 채로 마커를 렌더링한다
4. 시스템이 필터링된 마커만 표시한다

### 예외 플로우

#### EF-003-1: 필터링 결과 없음

**발생 시점**: 기본 플로우 5단계

1. 선택된 카테고리에 해당하는 장소가 현재 영역에 없다
2. 시스템이 모든 마커를 제거한다
3. 시스템이 지도 하단에 "이 지역에 [카테고리명] 장소가 없습니다" 안내 메시지를 표시한다
4. 시스템이 필터 상태는 유지한다
5. 사용자가 지도를 이동하거나 필터를 변경한다

#### EF-003-2: 상태 업데이트 실패

**발생 시점**: 기본 플로우 4단계

1. Zustand 스토어 업데이트가 실패한다
2. 시스템이 에러를 캐치한다
3. 시스템이 이전 필터 상태로 롤백한다
4. 시스템이 토스트 메시지로 "필터 적용 중 오류가 발생했습니다" 표시한다

### 비기능 요구사항

- **성능**: 필터 변경 후 마커 재렌더링 300ms 이내
- **UX**: 필터 버튼 클릭 시 즉각적인 시각적 피드백 (100ms 이내)
- **UX**: 선택된 카테고리 명확히 구분 (색상 대비 4.5:1 이상)
- **접근성**: 키보드로 필터 버튼 탐색 가능
- **접근성**: 스크린 리더 사용자를 위한 aria-pressed 속성 적용
- **상태 지속성**: 필터 상태를 세션 스토리지에 저장 (선택사항)

### 테스트 시나리오

#### TS-003-1: 단일 카테고리 필터링

- 조건: "한식" 카테고리 선택
- 예상 결과: 한식 마커만 표시, 버튼 강조

#### TS-003-2: 다중 카테고리 필터링

- 조건: "한식", "일식" 연속 선택
- 예상 결과: 두 카테고리 마커 모두 표시, 두 버튼 강조

#### TS-003-3: 카테고리 토글

- 조건: "한식" 선택 → "한식" 재선택
- 예상 결과: 한식 필터 해제, 전체 마커 표시

#### TS-003-4: 필터 초기화

- 조건: 여러 카테고리 선택 후 "전체" 클릭
- 예상 결과: 모든 필터 해제, 전체 마커 표시

---

## UC-004: 현재 위치 기반 탐색

### 기본 정보

- **유스케이스 ID**: UC-004
- **유스케이스 이름**: 현재 위치 기반 탐색
- **액터**: 일반 사용자
- **우선순위**: P1 (Should Have)
- **복잡도**: 중간

### 사전 조건

- 사용자가 홈 페이지에 접속한 상태
- 지도가 정상적으로 로드되어 있음
- 사용자의 디바이스가 위치 정보를 지원함

### 사후 조건

- 지도가 사용자의 현재 위치로 이동함
- 현재 위치 마커가 지도에 표시됨
- 현재 위치 주변의 장소 마커가 표시됨

### 기본 플로우

1. 사용자가 지도 우측 하단의 "현재 위치" 버튼을 클릭한다
2. 시스템이 위치 권한 상태를 확인한다
3. 시스템이 Geolocation API를 호출하여 현재 위치 좌표를 획득한다
4. 시스템이 로딩 인디케이터를 표시한다 (버튼에 스피너 표시)
5. 시스템이 현재 위치 좌표를 성공적으로 획득한다
6. 시스템이 지도를 현재 위치로 부드럽게 이동한다 (애니메이션, 1초 duration)
7. 시스템이 현재 위치에 특수 마커를 표시한다 (파란색 원 + 펄스 애니메이션)
8. 시스템이 줌 레벨을 15로 설정한다
9. 시스템이 현재 영역의 장소 데이터를 요청한다
10. 시스템이 주변 장소 마커를 렌더링한다
11. 시스템이 로딩 인디케이터를 숨긴다
12. 시스템이 토스트 메시지로 "현재 위치로 이동했습니다" 표시한다 (선택사항)

### 대체 플로우

#### AF-004-1: 이미 현재 위치에 있음

**분기점**: 기본 플로우 5단계 이후

**조건**: 획득한 위치와 현재 지도 중심이 매우 가까움 (100m 이내)

1. 시스템이 지도를 이동하지 않는다
2. 시스템이 현재 위치 마커만 업데이트한다
3. 시스템이 토스트 메시지로 "이미 현재 위치입니다" 표시한다

#### AF-004-2: 위치 권한 이미 허용됨

**분기점**: 기본 플로우 2단계

**조건**: 위치 권한이 이전에 허용됨

1. 시스템이 별도의 권한 요청 없이 Geolocation API를 호출한다
2. 기본 플로우 3단계로 이동한다

#### AF-004-3: 저정확도 위치 정보

**분기점**: 기본 플로우 5단계 이후

**조건**: 위치 정확도가 100m 이상

1. 시스템이 현재 위치 마커를 더 큰 반경으로 표시한다 (정확도 시각화)
2. 시스템이 토스트 메시지로 "위치 정확도가 낮습니다" 안내한다
3. 기본 플로우 6단계로 이동한다

### 예외 플로우

#### EF-004-1: 위치 권한 거부

**발생 시점**: 기본 플로우 2단계

1. 사용자가 위치 권한을 거부한다
2. 시스템이 로딩 인디케이터를 숨긴다
3. 시스템이 토스트 메시지로 "위치 권한이 필요합니다" 표시한다
4. 시스템이 권한 설정 방법을 안내하는 다이얼로그를 표시한다 (선택사항)
5. 유스케이스 종료

#### EF-004-2: 위치 정보 획득 실패

**발생 시점**: 기본 플로우 3단계

1. Geolocation API 호출이 실패한다 (GPS 오류, 타임아웃 등)
2. 시스템이 에러를 캐치한다
3. 시스템이 로딩 인디케이터를 숨긴다
4. 시스템이 토스트 메시지로 "위치를 가져올 수 없습니다. 다시 시도해주세요." 표시한다
5. 시스템이 지도를 이동하지 않는다
6. 유스케이스 종료

#### EF-004-3: 위치 정보 획득 타임아웃

**발생 시점**: 기본 플로우 3단계

**조건**: 위치 정보 획득이 10초 이상 소요

1. 시스템이 타임아웃 에러를 발생시킨다
2. 시스템이 로딩 인디케이터를 숨긴다
3. 시스템이 토스트 메시지로 "위치 확인이 지연되고 있습니다. 잠시 후 다시 시도해주세요." 표시한다
4. 유스케이스 종료

#### EF-004-4: Geolocation API 미지원 브라우저

**발생 시점**: 기본 플로우 2단계

1. 시스템이 Geolocation API 지원 여부를 확인한다
2. API가 지원되지 않음을 감지한다
3. 시스템이 "현재 위치" 버튼을 비활성화한다
4. 시스템이 토스트 메시지로 "이 브라우저는 위치 기능을 지원하지 않습니다" 표시한다
5. 유스케이스 종료

### 비기능 요구사항

- **성능**: 위치 정보 획득 시간 5초 이내 (타임아웃 10초)
- **성능**: 지도 이동 애니메이션 1초 (부드러운 전환)
- **UX**: 버튼 클릭 시 즉각적인 시각적 피드백 (로딩 스피너)
- **UX**: 현재 위치 마커 명확히 구분 (파란색 펄스 애니메이션)
- **정확도**: 위치 정확도 옵션 `enableHighAccuracy: true` 설정
- **접근성**: 버튼에 "현재 위치로 이동" aria-label 적용
- **배터리**: 위치 추적 지속하지 않음 (일회성 위치 획득만)

### 테스트 시나리오

#### TS-004-1: 정상적인 위치 이동

- 조건: 위치 권한 허용, GPS 정상 작동
- 예상 결과: 현재 위치로 지도 이동, 파란색 마커 표시

#### TS-004-2: 위치 권한 거부

- 조건: 위치 권한 거부
- 예상 결과: 에러 메시지 표시, 지도 이동 없음

#### TS-004-3: GPS 꺼진 상태

- 조건: 디바이스 GPS 비활성화
- 예상 결과: 타임아웃 에러 메시지 표시

#### TS-004-4: 저정확도 위치

- 조건: 실내에서 GPS 신호 약함
- 예상 결과: 넓은 반경의 위치 마커 표시, 정확도 경고

---

## 부록

### A. 관련 API 엔드포인트

#### GET /api/places
```typescript
// 쿼리 파라미터
interface PlacesQuery {
  lat1: number;    // 남서쪽 위도
  lng1: number;    // 남서쪽 경도
  lat2: number;    // 북동쪽 위도
  lng2: number;    // 북동쪽 경도
  category?: string; // 카테고리 필터 (쉼표 구분)
}

// 응답
interface PlacesResponse {
  success: true;
  data: {
    places: Array<{
      id: string;
      name: string;
      latitude: number;
      longitude: number;
      category: string;
      averageRating: number;
      reviewCount: number;
    }>;
  };
}
```

#### GET /api/search
```typescript
// 쿼리 파라미터
interface SearchQuery {
  query: string;
  latitude?: number;
  longitude?: number;
  display?: number;  // 기본값: 20
}

// 응답
interface SearchResponse {
  success: true;
  data: {
    places: Array<{
      title: string;
      address: string;
      category: string;
      telephone: string;
      latitude: number;
      longitude: number;
      naverPlaceId: string;
    }>;
  };
}
```

### B. 카테고리 매핑

| 내부 카테고리 | 네이버 API 카테고리 | 아이콘 | 색상 |
|-------------|-------------------|--------|------|
| 한식 | 한식, 한정식, 백반, 찌개 | 🍚 | #FF6B6B |
| 일식 | 일식, 초밥, 돈까스, 라멘 | 🍣 | #4ECDC4 |
| 양식 | 양식, 스테이크, 파스타 | 🥩 | #95E1D3 |
| 중식 | 중식, 중화요리 | 🥟 | #F38181 |
| 카페 | 카페, 디저트, 베이커리 | ☕ | #AA96DA |
| 기타 | 위 카테고리 외 모든 음식점 | 📍 | #FCBAD3 |

### C. 로컬 스토리지 스키마

#### 최근 검색어
```typescript
// localStorage key: 'mafia-search-history'
interface SearchHistory {
  searches: Array<{
    query: string;
    searchedAt: string; // ISO 8601
  }>;
}

// 최대 10개 저장
// FIFO 방식으로 오래된 항목 자동 삭제
```

#### 필터 상태 (세션 스토리지)
```typescript
// sessionStorage key: 'mafia-filter-state'
interface FilterState {
  selectedCategories: string[]; // ['한식', '일식']
  updatedAt: string;
}
```

### D. 지도 설정 상수

```typescript
// 지도 초기 설정
const MAP_CONFIG = {
  DEFAULT_CENTER: { lat: 37.5665, lng: 126.9780 }, // 서울시청
  DEFAULT_ZOOM: 15,
  MIN_ZOOM: 10,
  MAX_ZOOM: 19,
  CLUSTER_MIN_ZOOM: 13,
  MAX_MARKERS: 100,
};

// 위치 정보 설정
const GEOLOCATION_CONFIG = {
  enableHighAccuracy: true,
  timeout: 10000, // 10초
  maximumAge: 60000, // 1분
};

// 검색 설정
const SEARCH_CONFIG = {
  DEBOUNCE_DELAY: 300, // ms
  MAX_RESULTS: 20,
  MIN_QUERY_LENGTH: 2,
};
```

### E. 에러 코드 정의

| 코드 | 메시지 | 설명 |
|------|--------|------|
| SEARCH_001 | 검색 중 오류가 발생했습니다 | 네이버 API 호출 실패 |
| SEARCH_002 | 일일 검색 한도를 초과했습니다 | API 할당량 초과 |
| SEARCH_003 | 검색어를 입력해주세요 | 빈 검색어 |
| MAP_001 | 지도를 불러올 수 없습니다 | 지도 SDK 로드 실패 |
| MAP_002 | 장소 정보를 불러올 수 없습니다 | 장소 데이터 API 실패 |
| LOCATION_001 | 위치 권한이 필요합니다 | 위치 권한 거부 |
| LOCATION_002 | 위치를 가져올 수 없습니다 | GPS 오류 |
| LOCATION_003 | 위치 확인이 지연되고 있습니다 | 타임아웃 |

---

## 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0.0 | 2025-10-21 | Development Team | 초안 작성 |

---

**문서 끝**
